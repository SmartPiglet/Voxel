var orderShippingDetails={template:`<div class="order-event" :class="status.class"><div class="order-event-icon"><icon-box/></div><b>{{ status.label }}</b> <span>{{ status.long_label }}</span><div class="further-actions"><a v-if="parent.isVendor() && status.key === 'processing'" href="#" @click.prevent="markShipped" class="ts-btn ts-btn-1">{{ data.l10n.mark_shipped }}</a><template v-if="parent.isVendor() && status.key === 'shipped'"><form-group :popup-key="'share-tracking-link-'+order.id" wrapper-class="md-width" ref="trackingLink" @save="shareTrackingLink" @clear="$refs.trackingLink.blur()" :clear-label="data.l10n.share_cancel" :save-label="data.l10n.share_confirm"><template #trigger><a href="#" @click.prevent="$root.activePopup = 'share-tracking-link-'+order.id" class="ts-popup-target ts-btn ts-btn-1"><template v-if="data.tracking_details.link">{{ data.l10n.update_tracking_link }}</template><template v-else>{{ data.l10n.share_tracking_link }}</template></a></template><template #popup><div class="ts-sticky-top uib b-bottom"><input type="url" v-model="share_details.tracking_link" :placeholder="data.l10n.tracking_url"></div></template></form-group></template><a v-if="parent.isCustomer() && status.key === 'shipped' && data.tracking_details.link" :href="data.tracking_details.link" target="_blank" class="ts-btn ts-btn-1">{{ data.l10n.track_order }} </a><a v-if="status.key === 'shipped'" @click.prevent="markDelivered" href="#" class="ts-btn ts-btn-1">{{ data.l10n.mark_delivered }}</a></div></div>`,props:{parent:Object,order:Object,data:Object},data(){return{share_details:{tracking_link:this.data.tracking_details.link}}},methods:{markShipped(){this.parent.running_action=!0,jQuery.post(Voxel_Config.ajax_url+"&action=products.single_order.shipping.mark_as_shipped",{order_id:this.order.id,_wpnonce:this.parent.orders.config.nonce}).always(a=>{this.parent.running_action=!1,a.success||Voxel.alert(a.message||Voxel_Config.l10n.ajaxError,"error"),this.parent.reload()})},markDelivered(){this.parent.running_action=!0,jQuery.post(Voxel_Config.ajax_url+"&action=products.single_order.shipping.mark_as_delivered",{order_id:this.order.id,_wpnonce:this.parent.orders.config.nonce}).always(a=>{this.parent.running_action=!1,a.success||Voxel.alert(a.message||Voxel_Config.l10n.ajaxError,"error"),this.parent.reload()})},shareTrackingLink(){this.parent.running_action=!0,jQuery.post(Voxel_Config.ajax_url+"&action=products.single_order.shipping.share_details",{order_id:this.order.id,tracking_link:this.share_details.tracking_link,_wpnonce:this.parent.orders.config.nonce}).always(a=>{this.parent.running_action=!1,a.success?(this.parent.reload(),this.share_details.tracking_link=a.tracking_link,this.$refs.trackingLink?.blur()):(Voxel.alert(a.message||Voxel_Config.l10n.ajaxError,"error"),this.parent.reload())})}},computed:{status(){return this.data.status}}};export{orderShippingDetails as default};
